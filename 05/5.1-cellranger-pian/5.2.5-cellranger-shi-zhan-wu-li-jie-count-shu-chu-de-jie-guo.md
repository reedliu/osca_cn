# 5.2.5 CellRangerå®žæˆ˜\(äº”\) ç†è§£countè¾“å‡ºçš„ç»“æžœ

> CellRanger countå‡ºæ¥çš„ç»“æžœï¼Œæ€Žä¹ˆçœ‹ï¼Ÿè¿™æ¬¡æ˜¯ä½œä¸ºäº†è§£çš„å†…å®¹

Cellrangerçš„ç»“æžœåŠ›æ±‚ä¸Žå¸¸è§„åˆ†æžçš„ç»“æžœæ ¼å¼ç›¸åŒï¼Œæ¯”å¦‚å®ƒç”Ÿæˆçš„ [barcoded BAM files](https://support.10xgenomics.com/single-cell-gene-expression/software/pipelines/2.0/output/bam) ä¹Ÿå¯ä»¥æ”¾åˆ°IGVä¸­æŸ¥çœ‹æ¯”å¯¹è´¨é‡

countç»“æžœä¸€èˆ¬æ”¾åœ¨`out`ç›®å½•ä¸‹ï¼Œä¸»è¦æœ‰summaryå’Œanalysisä¸¤å¤§ç±»ï¼ŒåŒ…å«ä»¥ä¸‹å‡ é¡¹ï¼š

![&#x56FE;1](https://jieandze1314-1255603621.cos.ap-guangzhou.myqcloud.com/blog/2019-09-20-031236.png)

#### Summary

> è¿™æ˜¯ä¸€ä¸ªhtmlæ ¼å¼çš„æ–‡ä»¶ï¼Œç›´æŽ¥ä¸‹è½½åˆ°æœ¬åœ°æ‰“å¼€

æ‰“å¼€æ—¶å°±èƒ½å¯¹æ•°æ®è¿›è¡Œä¸€ä¸ªåˆ¤æ–­ï¼Œ**ç½‘é¡µé¡¶ç«¯é¢œè‰²**æ˜¾ç¤ºä¸ºé»„è‰²æˆ–è€…çº¢è‰²è¯´æ˜Žæ•°æ®å­˜åœ¨å¼‚å¸¸

![&#x56FE;2](https://jieandze1314-1255603621.cos.ap-guangzhou.myqcloud.com/blog/2019-09-20-031243.png)

ç„¶åŽ**ç‚¹å‡»Details**ï¼Œå¯ä»¥çœ‹åˆ°ä¸ºä½•æ•°æ®å‡ºé”™ï¼š

![&#x56FE;3](https://jieandze1314-1255603621.cos.ap-guangzhou.myqcloud.com/blog/2019-09-20-031250.png)

ç»“æžœéƒ¨åˆ†åŒ…æ‹¬å®žéªŒæ•èŽ·çš„ç»†èƒžæ•°ç›®ã€æ£€æµ‹åˆ°çš„åŸºå› æ•°ç›®ã€æµ‹åºæ•°æ®çš„äº§å‡ºä¸Žè´¨é‡ç»Ÿè®¡ã€å‚è€ƒåŸºå› ç»„çš„æ¯”å¯¹æƒ…å†µ

\(ç¬¬ä¸€å¼ ä¸ºV2è¯•å‰‚çš„ç»“æžœ\)

![&#x56FE;4](https://jieandze1314-1255603621.cos.ap-guangzhou.myqcloud.com/blog/2019-09-20-031257.png)

\(ç¬¬äºŒå¼ ä¸ºV3è¯•å‰‚çš„ç»“æžœ\)

![&#x56FE;5](https://jieandze1314-1255603621.cos.ap-guangzhou.myqcloud.com/blog/2019-09-20-031304.png)

**å‡ ä¸ªæŒ‡æ ‡å¯ä»¥å…³æ³¨ä¸€ä¸‹ï¼š**

* å·¦ä¸Šéƒ¨åˆ†ä¸­ï¼ŒåŒ…æ‹¬äº†readsæ•°ã€barcodesæ•°ã€UMIã€indexã€Q30ç­‰ç»Ÿè®¡å€¼
* å·¦ä¸‹æ˜¯readsæ¯”å¯¹çš„æ¯”ä¾‹ï¼ŒåŒ…æ‹¬åŸºå› é—´åŒºã€å¤–æ˜¾å­ã€å†…å«å­ï¼Œå¦‚æžœæ¯”å¯¹çŽ‡å¤ªä½Ž\(ä¸€èˆ¬è®¤ä¸ºå¤–æ˜¾å­çš„æ¯”å¯¹çŽ‡è¦åœ¨60%ä»¥ä¸Š\)
* å³ä¸Šå›¾æ˜¯åˆ©ç”¨barcodesä¸Šçš„UMIæ ‡ç­¾åˆ†å¸ƒæ¥ä¼°è®¡ç»†èƒžæ•°ï¼Œç»¿/è“è‰²è¡¨ç¤ºç»†èƒžï¼Œç°è‰²è¡¨ç¤ºèƒŒæ™¯ï¼Œå…¶ä¸­Yè½´è¡¨ç¤ºæ¯ä¸ªbarcodeå¯¹åº”çš„UMIæ•°é‡ï¼ŒXè½´æ˜¯ä¸€å®šæ•°é‡çš„UMIåºåˆ—æ‰€å¯¹åº”barcodeçš„æ•°é‡ï¼Œæ¯”å¦‚ä¸Šå›¾ä¸­æœ‰1000ä¸ªbarcodeså«æœ‰10kä¸ªUMIï¼Œ**ç»†èƒžè¿‡æ»¤**å°±æ˜¯é€šè¿‡è¿™ä¸ªå›¾æ¥å±•ç¤ºçš„ã€‚

  é¦–å…ˆæ˜Žç¡®ï¼Œbarcodeç”¨æ¥åŒºåˆ†ç»†èƒžï¼ŒUMIç”¨æ¥åŒºåˆ†è½¬å½•æœ¬ï¼›å…¶æ¬¡ï¼Œbarcodesæ•°é‡æ—¶è¦å¤§äºŽç»†èƒžæ•°é‡çš„ï¼ˆä»¥ä¿è¯æ¯ä¸ªç»†èƒžéƒ½ä¼šæœ‰barcodeæ¥è¿›è¡ŒåŒºåˆ†ï¼‰å¦‚æžœå›¾çº¿é™¡é™è¯´æ˜Ž

> ä¸‹é¢ðŸ‘‡æ˜¯åœ¨å¯¹åŽŸæ–‡æ•°æ®è¿›è¡Œcountæ—¶é‡åˆ°çš„ä¸€ä¸ªé—®é¢˜ï¼Œè®°å½•ä¸‹æ¥

#### åŽŸæ–‡çš„å°å‘

å…¶å®žæœ‰äº†å‚è€ƒä¿¡æ¯ä¸ŽåŽŸå§‹åºåˆ—ï¼Œè·‘ä¸€ä¸ªcountå‘½ä»¤å¹¶ä¸éš¾ï¼Œä½†æ˜¯å¯¹äºŽè¿™ç¯‡æ–‡ç« æ¥è®²ï¼Œæœ‰ä¸€ä¸ªå°å‘éœ€è¦æ³¨æ„ï¼šçœ‹åŽŸæ–‡çš„æ–¹æ³•æè¿°

![&#x56FE;6](https://jieandze1314-1255603621.cos.ap-guangzhou.myqcloud.com/blog/2019-09-20-031313.png)

åŽŸæ–‡æ˜¯éœ€è¦å°†**hg38å’ŒMerkel cell polyomavirus, MCPyV\(é»˜å…‹å°”ç»†èƒžå¤šç˜¤ç—…æ¯’\)**çš„åŸºå› ç»„å…±åŒä½œä¸ºå‚è€ƒåºåˆ—åŽ»æ¯”å¯¹ï¼ŒåŸºæœ¬æ“ä½œæµç¨‹ç±»ä¼¼è¿™æ ·ï¼š

![&#x56FE;7](https://jieandze1314-1255603621.cos.ap-guangzhou.myqcloud.com/blog/2019-09-20-031534.png)

å…¶ä¸­ï¼Œhg38çš„fastaä¸ŽgtfèŽ·å–æ¯”è¾ƒå®¹æ˜“ï¼Œç›´æŽ¥ä¸‹è½½å³å¯\(å…·ä½“è§"å•ç»†èƒžå®žæˆ˜â€”å››"\)ï¼Œä½†æ˜¯ä½œè€…è¿˜ç”¨åˆ°äº†è¿™ä¸ªMCPyVï¼Œå®ƒçš„åŸºå› ç»„ä¹Ÿæ˜¯æ¯”è¾ƒå®¹æ˜“èŽ·å¾—[https://www.ncbi.nlm.nih.gov/nuccore/NC\_010277ï¼Œä½†æ˜¯\*\*gtfæ€Žä¹ˆèŽ·å¾—\*\*æ˜¯ä¸ªé—®é¢˜ï¼Œä½œè€…ç»™å‡ºçš„è§£ç­”æ˜¯ï¼šéœ€è¦ç”¨åŸºå› ç»„fastaè‡ªå·±ç”Ÿæˆgtfæ–‡ä»¶](https://www.ncbi.nlm.nih.gov/nuccore/NC_010277ï¼Œä½†æ˜¯**gtfæ€Žä¹ˆèŽ·å¾—**æ˜¯ä¸ªé—®é¢˜ï¼Œä½œè€…ç»™å‡ºçš„è§£ç­”æ˜¯ï¼šéœ€è¦ç”¨åŸºå› ç»„fastaè‡ªå·±ç”Ÿæˆgtfæ–‡ä»¶)

![&#x56FE;8](https://jieandze1314-1255603621.cos.ap-guangzhou.myqcloud.com/blog/2019-09-20-031323.png)

è¿™ä¸ªæ€è·¯å¾ˆé‡è¦ï¼Œä½†æ˜¯**å¦‚ä½•å°†åŸºå› ç»„fastaè½¬ä¸ºgtf**ï¼Œè¿˜æ˜¯ä¸ªé—®é¢˜ï¼ŒäºŽæ˜¯æœ¬ç€"è‡ªå·±çš„é”…è‡ªå·±èƒŒ"çš„åŽŸåˆ™ï¼ŒåˆåŽ»é—®äº†ä½œè€…

![&#x56FE;9](https://jieandze1314-1255603621.cos.ap-guangzhou.myqcloud.com/blog/2019-09-20-031330.png)

æœ¬ä»¥ä¸ºäººå®¶ä¸ä¼šç»™å›žä¿¡æ¯ï¼Œå› ä¸ºé—®çš„é—®é¢˜å¥½åƒæœ‰ç‚¹å’Œä»–ä»¬æ–‡ç« æ²¡ä»€ä¹ˆå…³ç³»äº†ï¼Œä½†ä»–çœŸçš„å›žä¿¡äº†å¹¶ä¸”å¾ˆè´Ÿè´£å‘Šè¯‰æˆ‘ï¼š"ä»–ä¹Ÿä¸ä¼šï¼"ï¼Œè§£å†³åŠžæ³•å°±æ˜¯ï¼š**æ‰‹åŠ¨æž„å»ºä¸€ä¸ª**

> å…¶å®žè¿™ä¸ªäº‹æƒ…å¯ä»¥å‘Šè¯‰æˆ‘ä»¬ï¼Œå¤çŽ°æ–‡ç« ä¸­é‡åˆ°é—®é¢˜æ—¶ï¼Œç›´æŽ¥å’ŒåŽŸä½œè€…æ²Ÿé€šæ˜¯æœ€æœ‰æ•ˆçš„æ–¹å¼ï¼ˆè¿™æ˜¯æˆ‘ç¬¬ä¸€æ¬¡å’Œä¸€ä½œç›´æŽ¥è¿›è¡Œäº¤æµï¼‰ã€‚ä¹‹å‰çš„æ—¶é—´éƒ½æ˜¯è‡ªå·±åœ¨æ‘¸ä¸ç€å¤´è„‘åœ°è¿›è¡Œå„ç§å°è¯•ï¼Œç„¶åŽæ‰¾ä»£ç ï¼Œç»“æžœéƒ½ä¸å¯ä»¥æˆåŠŸ

**å…ˆæŠŠåŸºå› ç»„åºåˆ—ä¸‹è½½ä¸‹æ¥**

![&#x56FE;10](https://jieandze1314-1255603621.cos.ap-guangzhou.myqcloud.com/blog/2019-09-20-031337.png)

**ç„¶åŽæ ¹æ®genbankçš„åºåˆ—ä¿¡æ¯ï¼Œé€ å‡º5ä¸ªCDSçš„æ³¨é‡Šä¿¡æ¯**

![&#x56FE;11](https://jieandze1314-1255603621.cos.ap-guangzhou.myqcloud.com/blog/2019-09-20-031344.png)

**åŸºæœ¬å°±æŒ‰ç…§è¿™ä¸ªæ ·å­æ¥å°±å¥½ï¼Œä¸éœ€è¦å¾ˆå¤æ‚**

éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œcellrangeråªèƒ½è¯†åˆ«exonï¼Œæ‰€ä»¥æˆ‘ä»¬ä¹Ÿè¦è¿™æ ·è®¾è®¡

![&#x56FE;12](https://jieandze1314-1255603621.cos.ap-guangzhou.myqcloud.com/blog/2019-09-20-031350.png)

```text
# æ¯ä¸€è¡Œæœ‰9åˆ—tabåˆ†éš”ä¿¡æ¯
# ç¬¬ä¸€åˆ—ï¼šChromosome æŒ‡å®šåŸºå› ç»„ä¸ŠæŸ“è‰²ä½“æˆ–contigä½ç½®
# ç¬¬äºŒåˆ—ï¼šSource è¿™ä¸ªç”¨å¤„ä¸å¤§
# ç¬¬ä¸‰åˆ—ï¼šFeature CellRangerè½¯ä»¶åªå–exonçš„éƒ¨åˆ†
# ç¬¬å››åˆ—ï¼šStart èµ·å§‹ä½ç‚¹(1-based)
# ç¬¬äº”åˆ—ï¼šEnd ç»ˆæ­¢ä½ç‚¹(1-based)
# ç¬¬å…­åˆ—ï¼šScore è¿™ä¸ªç”¨å¤„ä¸å¤§ï¼Œå»ºè®®ç”¨"."è¡¨ç¤º
# ç¬¬ä¸ƒåˆ—ï¼šStrand featureä¿¡æ¯åœ¨åŸºå› ç»„çš„+æˆ–-é“¾
# ç¬¬å…«åˆ—ï¼šFrame ç”¨å¤„ä¸å¤§ï¼Œå»ºè®®â€œ.â€
# ç¬¬ä¹åˆ—ï¼šåˆ†å·åˆ†éš”çš„é”®å€¼å¯¹ï¼Œé‡ç‚¹æ˜¯transcript_id å’Œgene_idã€‚gene_nameå¯é€‰
ADE45414.1_1     Gnomon  exon    465    1190    .       -       .       gene_id "1"; transcript_id "1.1";
ADE45415.1_2     Gnomon  exon    1156   2427    .       -       .       gene_id "1"; transcript_id "1.1";
ADE45416.1_3     Gnomon  exon    2503   4722    .       -       .       gene_id "1"; transcript_id "1.1";
ADE45416.1_3     Gnomon  exon    5154   5387    .       -       .       gene_id "1"; transcript_id "1.1";
ADE45417.1_4     Gnomon  exon    4827   5387    .       -       .       gene_id "1"; transcript_id "1.1";
```

ä½†æ˜¯è‡ªå·±æž„å»ºæ—¶ï¼Œ**ä¸€å®šè¦æ³¨æ„ä½¿ç”¨tabåˆ†éš”**ï¼Œå³ä½¿çœ‹ä¸ŠåŽ»åƒä¹Ÿä¸å¯ä¿¡ï¼Œæ£€æŸ¥çš„æ–¹æ³•æœ‰ä¸¤ä¸ªï¼š

ä¸€ä¸ªæ˜¯ç›´æŽ¥è¿è¡Œ`cellranger mkgtf` çœ‹æ˜¯å¦æŠ¥é”™ï¼Œå¯èƒ½ä¼šæç¤ºï¼šGTFçš„è¡Œæ•°ä¸å¯¹ï¼›

å¦ä¸€ä¸ªæ˜¯ç›´æŽ¥æ£€æŸ¥ï¼š`awk -F '\t' '{print NF}' mcv.gtf`ï¼Œå¦‚æžœæ˜¾ç¤º1ï¼Œé‚£ä¹ˆè¯´æ˜Žæ²¡æœ‰tabåˆ†éš”ï¼Œè€Œæ˜¯ç”¨çš„å¤šä¸ªç©ºæ ¼ï¼Œåˆ©ç”¨sedå¯ä»¥æŠŠè¿™äº›ç©ºæ ¼æ›¿æ¢æˆtabï¼š

`sed 's/ \+ /\t/g' inputfile > outputfile`

